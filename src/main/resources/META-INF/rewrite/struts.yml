#
# Copyright 2024 the original author or authors.
# <p>
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
# <p>
# https://www.apache.org/licenses/LICENSE-2.0
# <p>
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
---
type: specs.openrewrite.org/v1beta/recipe
name: org.openrewrite.java.struts.MigrateStruts6
displayName: Migrate to Struts 6
description: Migrate Struts 2 to Struts 6
recipeList:
  - org.openrewrite.java.struts.MigrateAwareInterfaces
  - org.openrewrite.java.struts.UpgradeStruts6Dependencies
---
type: specs.openrewrite.org/v1beta/recipe
name: org.openrewrite.java.struts.UpgradeStruts6Dependencies
displayName: Upgrade Struts 6 dependencies
description: Upgrade Struts 2 dependencies to Struts 6
recipeList:
  - org.openrewrite.maven.upgrade.UpgradeDependencyVersion:
      groupId: org.apache.struts
      artifactId: '*'
      newVersion: 6.x
---
type: specs.openrewrite.org/v1beta/recipe
name: org.openrewrite.java.struts.MigrateStruts6Constants
displayName: Migrate to Struts 6 constants
description: All Xwork constants had been already deprecated, with this version all of them have been removed and Struts constants have been used instead.
preconditions:
  - org.openrewrite.java.struts.search.FindStrutsXml
recipeList:
  - org.openrewrite.xml.ChangeTagAttribute:
      elementName: constant
      attributeName: name
      oldValue: collectionConverter
      newValue: struts.converter.collection
  - org.openrewrite.xml.ChangeTagAttribute:
      elementName: constant
      attributeName: name
      oldValue: dateConverter
      newValue: struts.converter.date
  - org.openrewrite.xml.ChangeTagAttribute:
      elementName: constant
      attributeName: name
      oldValue: numberConverter
      newValue: struts.converter.number
  - org.openrewrite.xml.ChangeTagAttribute:
      elementName: constant
      attributeName: name
      oldValue: stringConverter
      newValue: struts.converter.string
  - org.openrewrite.xml.ChangeTagAttribute:
      elementName: constant
      attributeName: name
      oldValue: arrayConverter
      newValue: struts.converter.array
  - org.openrewrite.xml.ChangeTagAttribute:
      elementName: constant
      attributeName: name
      oldValue: devMode
      newValue: struts.devMode
  - org.openrewrite.xml.ChangeTagAttribute:
      elementName: constant
      attributeName: name
      oldValue: logMissingProperties
      newValue: struts.ognl.logMissingProperties
  - org.openrewrite.xml.ChangeTagAttribute:
      elementName: constant
      attributeName: name
      oldValue: enableOGNLExpressionCache
      newValue: struts.ognl.enableExpressionCache
  - org.openrewrite.xml.ChangeTagAttribute:
      elementName: constant
      attributeName: name
      oldValue: enableOGNLEvalExpression
      newValue: struts.ognl.enableEvalExpression
  - org.openrewrite.xml.ChangeTagAttribute:
      elementName: constant
      attributeName: name
      oldValue: reloadXmlConfiguration
      newValue: struts.configuration.xml.reload
  - org.openrewrite.xml.ChangeTagAttribute:
      elementName: constant
      attributeName: name
      oldValue: allowStaticMethodAccess
      newValue: struts.ognl.allowStaticMethodAccess
  - org.openrewrite.xml.ChangeTagAttribute:
      elementName: constant
      attributeName: name
      oldValue: ognlExcludedClasses
      newValue: struts.excludedClasses
  - org.openrewrite.xml.ChangeTagAttribute:
      elementName: constant
      attributeName: name
      oldValue: ognlExcludedPackageNamePatterns
      newValue: struts.excludedPackageNamePatterns
  - org.openrewrite.xml.ChangeTagAttribute:
      elementName: constant
      attributeName: name
      oldValue: ognlExcludedPackageNames
      newValue: struts.excludedPackageNames
  - org.openrewrite.xml.ChangeTagAttribute:
      elementName: constant
      attributeName: name
      oldValue: additionalExcludedPatterns
      newValue: struts.additional.excludedPatterns
  - org.openrewrite.xml.ChangeTagAttribute:
      elementName: constant
      attributeName: name
      oldValue: additionalAcceptedPatterns
      newValue: struts.additional.acceptedPatterns
  - org.openrewrite.xml.ChangeTagAttribute:
      elementName: constant
      attributeName: name
      oldValue: overrideExcludedPatterns
      newValue: struts.override.excludedPatterns
  - org.openrewrite.xml.ChangeTagAttribute:
      elementName: constant
      attributeName: name
      oldValue: overrideAcceptedPatterns
      newValue: struts.override.acceptedPatterns
  - org.openrewrite.xml.ChangeTagAttribute:
      elementName: constant
      attributeName: name
      oldValue: struts.xwork.chaining.copyErrors
      newValue: struts.chaining.copyErrors
  - org.openrewrite.xml.ChangeTagAttribute:
      elementName: constant
      attributeName: name
      oldValue: struts.xwork.chaining.copyFieldErrors
      newValue: struts.chaining.copyFieldErrors
  - org.openrewrite.xml.ChangeTagAttribute:
      elementName: constant
      attributeName: name
      oldValue: struts.xwork.chaining.copyMessages
      newValue: struts.chaining.copyMessages
  - org.openrewrite.xml.ChangeTagAttribute:
      elementName: constant
      attributeName: name
      oldValue: xwork.autoGrowCollectionLimit
      newValue: struts.ognl.autoGrowthCollectionLimit
  - org.openrewrite.xml.ChangeTagAttribute:
      elementName: constant
      attributeName: name
      oldValue: objectFactory.classloader
      newValue: struts.objectFactory.classloader
#  xwork.loggerFactory	<not used any more>
---
type: specs.openrewrite.org/v1beta/recipe
name: org.openrewrite.java.struts.MigrateAwareInterfaces
displayName: Migrate Struts 2 interceptors to action "aware" interfaces
description: These types have moved to a new package in Struts 6.
recipeList:
  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: org.apache.struts2.interceptor.ApplicationAware
      newFullyQualifiedTypeName: org.apache.struts2.action.ApplicationAware
  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: org.apache.struts2.interceptor.CookiesAware
      newFullyQualifiedTypeName: org.apache.struts2.action.CookiesAware
  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: org.apache.struts2.interceptor.HttpParametersAware
      newFullyQualifiedTypeName: org.apache.struts2.action.ParametersAware
  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: org.apache.struts2.interceptor.ParameterAware
      newFullyQualifiedTypeName: org.apache.struts2.action.ParametersAware
  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: org.apache.struts2.interceptor.PrincipalAware
      newFullyQualifiedTypeName: org.apache.struts2.action.PrincipalAware
  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: org.apache.struts2.interceptor.RequestAware
      newFullyQualifiedTypeName: org.apache.struts2.action.ServletRequestAware
  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: org.apache.struts2.interceptor.ServletRequestAware
      newFullyQualifiedTypeName: org.apache.struts2.action.ServletRequestAware
  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: org.apache.struts2.interceptor.ServletResponseAware
      newFullyQualifiedTypeName: org.apache.struts2.action.ServletResponseAware
  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: org.apache.struts2.interceptor.SessionAware
      newFullyQualifiedTypeName: org.apache.struts2.action.SessionAware
  - org.openrewrite.java.ChangeType:
      oldFullyQualifiedTypeName: org.apache.struts2.util.ServletContextAware
      newFullyQualifiedTypeName: org.apache.struts2.action.ServletContextAware
